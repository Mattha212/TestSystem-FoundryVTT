<form class="actor-sheet" autocomplete="off" form data-sheet-part="form" method="POST">
    <header class="sheet-header">
        <div class="portrait">
            <img src="{{actor.img}}" data-edit="img" title="{{actor.name}}"/>
        </div>
        <div class="char-info">
            <input type="text" name="system.playerName" value="{{system.playerName}}"/>Player name
            <input type="text" name="name" value="{{actor.name}}"/>Character name
            <input type="text" name="system.characterGender" value="{{system.characterGender}}"/>Gender
            <input type="number" name="system.age" value="{{system.age}}"/>Age
            <label for="culture">Culture :</label>
            <select name="system.culture" id="culture">
            <option value="">-- Sélectionne une culture --</option>
            {{#each cultures}}
                <option value="{{this.name}}" {{#if (eq ../system.culture this.name)}}selected{{/if}}>
                {{this.name}}
                </option>
            {{/each}}
            </select>
            <label for="subculture">Sous-culture :</label>
            <select name="system.subculture" id="subculture">
            <option value="">-- Sélectionne une sous-culture --</option>
            {{#each subcultures}}
                <option value="{{this.name}}" {{#if (eq ../system.subculture this.name)}}selected{{/if}}>
                {{this.name}}
                </option>
            {{/each}}
            </select>
        </div>
        <div class="traits">
            <ol class="trait-list">
                {{#each traits}}   
                <li class="trait" data-item-id="{{this.id}}">
                <span class="trait-name">{{this.name}}</span>
                <button type="button" class="delete-trait" data-action="deleteTrait" data-trait-id="{{this.id}}">Remove trait</button>
                </li>
                {{/each}}
            </ol>
        </div>
    </header>
    <section class ="sheet-stats">
        {{#each system.stats as |stat key|}}
        <div class = "stat-block">
            <button type="button" class = "stat-roll" data-action = "statRoll" data-stat="{{key}}">{{stat.Label}}</button>
            <div class="stat-values">
                <input type="number" name="system.stats.{{key}}.MaxValue" value = "{{stat.MaxValue}}"/>
                <span>/</span>
            {{#if (or (eq key "Constitution") (eq key "Vigor"))}}
            <input type="number" name="system.stats.{{key}}.CurrentValue" value="{{stat.CurrentValue}}" />
            {{else}}
            <span class="CurrentValues">{{stat.CurrentValue}}</span>
            {{/if}}
            </div>
        </div>        
        {{/each}}
    </section>
    <nav class="tabs sheet-tabs" data-group="primary">
        <a class="item" data-tab="skillsTab" data-action="changeTab">Skills</a>
        <a class="item" data-tab="fightingTab" data-action="changeTab">Fighting</a>
        <a class="item" data-tab="inventoryTab" data-action="changeTab">Inventory</a>
    </nav>
 
<section class="sheet-body" data-application-part="body">
  <div class="tab {{tabs.skillsTab.cssClass}}" data-tab="{{tabs.skillsTab.id}}" data-group="{{tabs.skillsTab.group}}" data-part="{{tabs.skillsTab.id}}">
    {{#each skills as |category categoryName|}}
      <div class="CategoryTitle">{{handleNames categoryName}}</div>
      <div class="skills">
        <div class="skills-header">
          <span></span>  
          <span>Level</span>
          <span>Learning Points</span>
        </div>
        <div class="skills-header-filler"></div>
        {{#each category as |skill skillname|}}
          <div class="skill-block">
            <button type="button" class="skill-roll" data-action="skillRoll" data-skillkey="{{skillname}}" data-category="{{handleNames categoryName}}">
              {{handleNames skillname}}
            </button>
            <div class="skill-input">
              <input type="number" name="system.skills.{{categoryName}}.{{skillname}}.level" value="{{skill.level}}"/>
            </div>
            <div class="skill-input">
              <input type="number" name="system.skills.{{categoryName}}.{{skillname}}.learningPoints" value="{{skill.learningPoints}}"/>
            </div>
          </div>
        {{/each}}
      </div>
    {{/each}}
  </div>

<div class="tab fighting {{tabs.fightingTab.cssClass}}"
     data-tab="{{tabs.fightingTab.id}}"
     data-group="{{tabs.fightingTab.group}}"
     data-part="{{tabs.fightingTab.id}}">

    <div class="fighting-grid">
        <div class="protection">
            <h5>Protection: {{system.protection}} </h5>
        </div>
        <div class="bulk">
            <h5>Bulk: {{system.bulk}} </h5>
        </div>
        <div class="category-block shields-block">
            <h3>Shields</h3>
            <div class="category-header">
                <span>Name</span>
                <span>Weight</span>
                <span>Protection</span>
                <span>Bulk</span>
                <span>Cost</span>
                <span class="actions">Actions</span>
            </div>
            <ul>
            {{#each shields}}
                <li class="item" data-item-id="{{this.id}}">
                    <span data-action="printItem" data-item-id="{{this.id}}">{{this.name}}</span>
                    <span>{{this.system.weight}} kg</span>
                    <span>{{this.system.protection}}</span>
                    <span>{{this.system.bulk}}</span>
                    <span>{{this.system.cost}}</span>
                    <div class="item-actions">
                        <button type="button" data-action="equipArmor" data-item-id="{{this.id}}" data-item-type="{{this.type}}">Equip</button>
                        <button type="button" data-action="unequipArmor" data-item-id="{{this.id}}" data-item-type="{{this.type}}">Unequip</button>
                        <button type="button" data-action="deleteItem" data-item-id="{{this.id}}">Remove</button>
                    </div>
                </li>
            {{/each}}
            </ul>
        </div>
        <div class="category-block armor-block">
            <h3>Armors</h3>
            <div class="category-header">
                <span>Name</span>
                <span>Weight</span>
                <span>Protection</span>
                <span>Bulk</span>
                <span>Cost</span>
                <span class="actions">Actions</span>
            </div>
            <ul>
            {{#each armors}}
                <li class="item" data-item-id="{{this.id}}">
                    <span data-action="printItem">{{this.name}}</span>
                    <span>{{this.system.weight}} kg</span>
                    <span>{{this.system.protection}}</span>
                    <span>{{this.system.bulk}}</span>
                    <span>{{this.system.cost}}</span>
                    <div class="item-actions">
                        <button type="button" data-action="equipArmor" data-item-id="{{this.id}}" data-item-type="{{this.type}}">Equip</button>
                        <button type="button" data-action="unequipArmor" data-item-id="{{this.id}}" data-item-type="{{this.type}}">Unequip</button>
                        <button type="button" data-action="deleteItem" data-item-id="{{this.id}}">Remove</button>
                    </div>
                </li>
            {{/each}}
            </ul>
        </div>
        <div class="category-block weapon-block">
            <h3>Weapons</h3>

            <div class="category-header">
                <span>Name</span>
                <span>Weight</span>
                <span>Efficiencies</span>
                <span>Traits</span>
                <span>Skill</span>
                <span>Bulk</span>
                <span>Cost</span>
                <span class="actions">Actions</span>
            </div>
            <ul>
            {{#each weapons}}
                <li class="item" data-item-id="{{this.id}}">
                    <span data-action="printItem">{{this.name}}</span>
                    <span>{{this.system.weight}} kg</span>

                    <span class="weapon-efficiency">
                        {{#each this.system.efficiency as |value key|}}
                            <div>{{key}}: {{value}}</div>
                        {{/each}}
                    </span>
                    <span>{{this.system.traits}}</span>
                    <span>{{this.system.skill}}</span>
                    <span>{{this.system.bulk}}</span>
                    <span>{{this.system.cost}}</span>
                    <div class="item-actions">
                        <button type="button" data-action="attack" data-item-skillkey="{{this.system.skill}}">Attack</button>
                        <button type="button" data-action="defense" data-item-skillkey="{{this.system.skill}}">Defense</button>
                        <button type="button" data-action="equipWeapon" data-item-id="{{this.id}}">Equip</button>
                        <button type="button" data-action="unequipWeapon" data-item-id="{{this.id}}">Unequip</button>
                        <button type="button" data-action="deleteItem" data-item-id="{{this.id}}">Remove</button>
                    </div>
                </li>
            {{/each}}
            </ul>
        </div>
        <div class="Fighting Manoeuveurs">
            <h3>Fighting Maneuveurs</h3>
            {{#each fightingManeuvers}}
            <li class="item" data-item-id="{{this.id}}">
                <span class="ManoeuveurName">{{this.name}}</span>
                <span class="ManoeuverCost">{{this.system.cost}}</span>
                {{#if this.system.rollable}}
                    <select name="this.system.weaponLinked" id="weaponLinked">
                        <option value="">-- Sélectionne une arme --</option>
                        {{#each ../weapons}}
                            <option value="{{this.name}}" {{#if (eq ../this.system.weaponLinked this.name)}}selected{{/if}}>
                            {{this.name}}
                            </option>
                        {{/each}}                        
                    </select>
                {{/if}}
            </li>
            {{/each}}
        </div>
    </div>
</div>

  {{!-- Inventory Tab --}}
  <div class="tab {{tabs.inventoryTab.cssClass}}" data-tab="{{tabs.inventoryTab.id}}" data-group="{{tabs.inventoryTab.group}}" data-part="{{tabs.inventoryTab.id}}">
    <ol class="item-list">
      {{#each objects}}
        <li class="item" data-item-id="{{this.id}}">
          <span class="itemName">{{this.name}}</span>
          <span class="item-weight">{{this.system.weight}} kg</span>
        </li>
      {{/each}}
    </ol>
  </div>
</section>
</form>
